<div class="game-container" style="background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.3)), url(<%= asset_path @playlist.picture %>)">

  <div class="created-game">
    <div id="answers" data-game-id="<%= @game.id %>">
    </div>
  </div>

<% if @game.created? %>
  <div class="top-container">
    <div class="welcome-top"><p> This is <%= @game.user.pseudo %>'s game</p>
      <% if @game.participants != nil %>
          <% @game.participants.each do |participant| %>
          <p><%= participant.pseudo %> is participating</p>
        <%end  %>
      <% end %>
    </div>
  </div>

  <div class="play">
    <h1>Clique sur le bouton <strong>PLAY</strong> dÃ¨s que ton adversaire a rejoint la partie pour la lancer ðŸ”Š</h1>
  </div>
  <div class="welcome-top">
    <div class="text-center">
      <p><strong>Your token :
        <%= @game.token %></p></strong>
    </div>
  </div>


    <%= link_to running_game_path(@game), method: :patch do %>
      <div class="play-btn"></div>
    <% end %>
  <% end %>

  <% if @game.ready? %>

    <h1><%= @participation.pseudo %> a rejoint le game</h1>
    <h1>Clique sur le bouton <strong>PLAY</strong> dÃ¨s que ton adversaire a rejoint la partie pour la lancer ðŸ”Š</h1>

      <div class="text-center">
        <p> <strong>Your token :
          <%= @game.token %></p></strong>
      </div>

    <%= link_to running_game_path(@game), method: :patch do %>
      <div class="play-btn"></div>
    <% end %>
  <% end %>

  <% if @game.running? %>
    <% if @current_track %>
      <ul class="list-inline d-flex align-items-center">
<!--         <li class="list-inline-item"><%= @current_track.title %></li> -->
        <li class="d-none list-inline-item audio" data-time="<%= @answering_time %>"><%= audio_tag("#{@current_track.url_preview}", autoplay: true, controls: true, id:"song") %></li>
      </ul>
      <div class="song-count d-flex justify-content-around align-items-center">
        <%= '<i class="fas fa-record-vinyl guessed"></i>'.html_safe * Answer.where(status:true).count %>
        <%= '<i class="fas fa-record-vinyl"></i>'.html_safe * (Game::NUMBER_OF_ROUNDS - Answer.where(status:true).count) %>
      </div>
      <div class="buzzer-content">
       <%= link_to paused_game_path(@game), method: :patch, id:"buzz" do %>
          <div class="buzzer">
            <div class="wave">
              <span></span>
              <span></span>
              <span></span>
              <span></span>
              <span></span>
            </div>
          </div>
        <% end %>
      </div>

    <% else %>

    <div class="display-container">
      <div class='dashboard-container'>
        <h3 >Your results :</h3>
          <table class="dashboard-table">
            <thead class='dashboard-titles'>
              <td>Track </td>
              <td>Player </td>
              <td>Pts </td>
            </thead>
            <tbody>
              <% @game.playlist.tracks.each do |track| %>
                <tr >
                  <td><%= track.title %> <%#= track.artist %> </td>
                    <% track.answers.each do |answer| %>
                      <% if answer.status = true %>
                        <td><%= answer.user.pseudo %> </td>
                          <% if answer.answering_time < 3 %>
                            <td class="top-score">+ 1000 </td>
                            <% elsif answer.answering_time < 5 %>
                              <td>+ 200 </td>
                            <% elsif answer.answering_time < 10 %>
                              <td>+ 50 </td>
                            <% else %>
                              <td>+ 10 </td>
                            <% end %>
                          <% else %>
                        <td> - </td>
                        <td> - </td>
                      <% end %>
                    <% end %>
                  <% end  %>
                </tr>
            </tbody>
          </table>
      </div>
    </div>
  <div class="dashboard-container mt-5">
    <h2>The big winner is :</h2>
  </div>
    <p>test </p>
  <% end %>
<% end %>

  <% if@game.paused? %>
    <div class="form-container">

      <%= simple_form_for [ @game, @answer ] do |f| %>
        <%= f.input :content %>
        <%= f.hidden_field :track, value: @current_track.id %>
        <%= f.hidden_field :answering_time, value: params[:current_time] %>
        <%= f.submit id:"answer"%>
      <% end %>
    </div>
  <% end %>
</div>

<!-- <div id="message-modal">
  <div class="form-modal">
    <p> <strong><%= @user.pseudo %></strong> a Ã©tÃ© plus rapide que toi ðŸš€ il donne une rÃ©ponse... </p>
  </div>
</div>
 -->

